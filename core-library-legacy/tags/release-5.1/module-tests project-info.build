<?xml version="1.0"?>

<!--
  Copyright 2005, University of Wisconsin-Madison
  Author: James Domingo, UW-Madison, FLEL
-->

<project name="Project information - Module Tests"
         default="project-info-file">
    <description>
    	Make the text file with the project information for the NUnit test
    	assembly associated with a core module.
    </description>

    <!--  ================================================================  -->

    <!--  This build file requires that these properties be defined:
    
              core-module__project-info
              tests__project-info
              tests__project-info__relative
    -->
    <foreach item="String"
             delim=","
             in="core-module__project-info,tests__project-info,tests__project-info__relative"
             property="property-name">
        <fail if="${not property::exists(property-name)}"
              message='Error:  The property "${property-name}" does not exist' />
    </foreach>
    
    <!--  ================================================================  -->

    <!--  Define the NAnt properties with the module's project info  -->
    <include buildfile="${core-module__project-info}" />

    <!--  ================================================================  -->

    <target name="project-info-file">
    
        <!--  property "action" : the action taken on the tests' project info:
                                  "Created" or "Updated"  -->
        <property name="action"
                  value="Created"
                  if="${not file::exists(tests__project-info)}" />
        <property name="action"
                  value="Updated"
                  if="${file::exists(tests__project-info)}" />

        <echo file="${tests__project-info}">#  Do not edit this file; it is generated by the build system.

project-name	${string::replace(project-name, 'Landis.', 'Landis.Test.')}
project-type	library
version		${project-version}
release		${project-release}
</echo>

        <echo message='${action} the file "${tests__project-info__relative}"' />
    </target>

</project>
